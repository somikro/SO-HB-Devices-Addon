#!/bin/sh

#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# addon name                  : so-hb-devices-addon
# addon version               : 1.1
#
# generated by AsksinPP_addon_generator 0.95
# generated on Fri Jul 11 21:04:55 CEST 2025

# XML control file name       : AsksinPP_addon_generator_control_file.xml

# creator                     : somikr
# created_on                  : 2025_07_11-20:45:22
# extract_rftypes_XML version : 0.14
#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# global settings for editing DEVDB.tcl
devdescrFile="/www/config/devdescr/DEVDB.tcl"
devdescrSearch="array[[:space:]]*set[[:space:]]*DEV_PATHS[[:space:]]*{"

#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# global settings for editing webui.js
webuiFile="/www/webui/webui.js"
webuiSearch="DEV_HIGHLIGHT[[:space:]]*=[[:space:]]*new Array();"


#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# iterate over the addon devices
#------------------------------------------------------------------------------
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# device name            : HB-UNI-SenAct-4-4-SC
# small case device name : hb-UNI-SenAct-4-4-SC
# XML version            : not specified
# index                  : 0
#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# in der WebUI angezeigter Gerätetyp, muss identisch sein mit dem Firmware-XML-Tag: <type name="HB-UNI-SenAct-4-4-SC" id="HB-UNI-SenAct-4-4-SC">
DEVICE="HB-UNI-SenAct-4-4-SC"
# in der WebUI angezeigte Gerätebeschreibung
DEVICE_DESC="4 actor channels with 4 binary state sensor channnels4 actor channels with 4 binary state sensor channnels, supporting AES"
# Name der Piktogramme, bestehend aus xx.png bzw. xx_thumb.png
DEVICE_IMG=hb-UNI-SenAct-4-4-SC.png
DEVICE_THUMB=hb-UNI-SenAct-4-4-SC_thumb.png
FIRMWARE_FILE=/firmware/rftypes/hb-UNI-SenAct-4-4-SC*.xml

# edit DEVDB.tcl
devdescrInsert="$DEVICE {{50 \/config\/img\/devices\/50\/$DEVICE_THUMB} {250 \/config\/img\/devices\/250\/$DEVICE_IMG}} "

if [ -z "`cat $devdescrFile | grep \"$DEVICE\"`" ]; then
	sed -i "s/\($devdescrSearch\)/\1$devdescrInsert/g" $devdescrFile
fi

# edit webui.js
webuiInsert="\n"
webuiInsert="${webuiInsert}DEV_HIGHLIGHT['$DEVICE'] = new Object();\n"
webuiInsert="${webuiInsert}DEV_LIST.push('$DEVICE');\n"
webuiInsert="${webuiInsert}DEV_DESCRIPTION['$DEVICE']='$DEVICE_DESC';\n"
webuiInsert="${webuiInsert}DEV_PATHS['$DEVICE'] = new Object();\n"
webuiInsert="${webuiInsert}DEV_PATHS['$DEVICE']['50'] = '\/config\/img\/devices\/50\/$DEVICE_THUMB';\n"
webuiInsert="${webuiInsert}DEV_PATHS['$DEVICE']['250'] = '\/config\/img\/devices\/250\/$DEVICE_IMG';"

if [ -z "`cat $webuiFile | grep \"$DEVICE\"`" ]; then
	sed -i "s/\($webuiSearch\)/\1$webuiInsert/g" $webuiFile
fi

#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# device name            : HB-UniNode-5O-5BI
# small case device name : hb-UniNode-5O-5BI
# XML version            : not specified
# index                  : 1
#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# in der WebUI angezeigter Gerätetyp, muss identisch sein mit dem Firmware-XML-Tag: <type name="HB-UniNode-5O-5BI" id="HB-UniNode-5O-5BI">
DEVICE="HB-UniNode-5O-5BI"
# in der WebUI angezeigte Gerätebeschreibung
DEVICE_DESC="Universal 5 channel Actuator with 5 channel binary sensor input"
# Name der Piktogramme, bestehend aus xx.png bzw. xx_thumb.png
DEVICE_IMG=hb-UniNode-5O-5BI.png
DEVICE_THUMB=hb-UniNode-5O-5BI_thumb.png
FIRMWARE_FILE=/firmware/rftypes/hb-UniNode-5O-5BI*.xml

# edit DEVDB.tcl
devdescrInsert="$DEVICE {{50 \/config\/img\/devices\/50\/$DEVICE_THUMB} {250 \/config\/img\/devices\/250\/$DEVICE_IMG}} "

if [ -z "`cat $devdescrFile | grep \"$DEVICE\"`" ]; then
	sed -i "s/\($devdescrSearch\)/\1$devdescrInsert/g" $devdescrFile
fi

# edit webui.js
webuiInsert="\n"
webuiInsert="${webuiInsert}DEV_HIGHLIGHT['$DEVICE'] = new Object();\n"
webuiInsert="${webuiInsert}DEV_LIST.push('$DEVICE');\n"
webuiInsert="${webuiInsert}DEV_DESCRIPTION['$DEVICE']='$DEVICE_DESC';\n"
webuiInsert="${webuiInsert}DEV_PATHS['$DEVICE'] = new Object();\n"
webuiInsert="${webuiInsert}DEV_PATHS['$DEVICE']['50'] = '\/config\/img\/devices\/50\/$DEVICE_THUMB';\n"
webuiInsert="${webuiInsert}DEV_PATHS['$DEVICE']['250'] = '\/config\/img\/devices\/250\/$DEVICE_IMG';"

if [ -z "`cat $webuiFile | grep \"$DEVICE\"`" ]; then
	sed -i "s/\($webuiSearch\)/\1$webuiInsert/g" $webuiFile
fi

#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
# ab hier siehe Anleitung von Jérôme, siehe https://homematic-forum.de/forum/viewtopic.php?f=76&t=60067
#------------------------------------------------------------------------------
#------------------------------------------------------------------------------
#------------------------------------------------------------------------------


webuiSearchBegin="elvST[[:space:]]*=[[:space:]]*new Array();"




### Edit webuiInsert ####

webuiFile="/www/webui/webui.js"



### Edit stringtable_de.txt ###

stringtable_deFile="/www/config/stringtable_de.txt"



### Edit translate.lang.stringtable.js ###

translate_deFile="/www/webui/js/lang/de/translate.lang.stringtable.js"
translate_deSearch="\"dummy\" : \"\","



#finished 'AsksinPP addon script generator 0.95'
